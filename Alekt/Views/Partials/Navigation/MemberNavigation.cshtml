@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
@using Umbraco.Web;
@{
    /**/

    var site = Model.Content.Site();
    var selection = site.Children.Where(x => x.IsVisible() && (x.HasProperty("excludeFromMenu") && x.GetPropertyValue<bool>("excludeFromMenu")));
}


@if (Umbraco.MemberIsLoggedOn())
{   
<ul class="member-navigation">
    @foreach (var item in selection)
    {
        var url = "";
        if (item.HasValue("linkImage"))
        {
            url = item.GetPropertyValue<IPublishedContent>("linkImage").Url;
        }
        <li style="background-image: url('@url')"><a href="@item.Url">@item.Name</a></li>
    }
</ul>
}

