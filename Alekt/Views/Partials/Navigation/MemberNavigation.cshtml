@inherits Umbraco.Web.Mvc.UmbracoTemplatePage
@using Umbraco.Web;
@{
    /**/

    var site = Model.Content.Site();
    var selection = site.Children.Where(x => x.IsVisible() && (x.HasProperty("excludeFromMenu") && x.GetPropertyValue<bool>("excludeFromMenu") || x.DocumentTypeAlias == "login"));
}


@if (Umbraco.MemberIsLoggedOn())
{   
<ul class="member-navigation">
    @foreach (var item in selection)
    {
        var url = "";
        var name = item.Name;
        if (item.HasValue("linkImage"))
        {
            url = item.GetPropertyValue<IPublishedContent>("linkImage").Url;
        }

        if(item.DocumentTypeAlias == "login")
        {
            name = item.GetPropertyValue<string>("pageTitle");
        }

        <li style="background-image: url('@url')"><a href="@item.Url">@name</a></li>
    }
</ul>
}

